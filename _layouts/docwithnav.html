<!-- Set this_pages_navbar  -->
{% comment %}
Here, we loop through site.data for the current view
to set two variables:
	1. this_pages_navbar - a object containing this page's navbar
	2. navbars - a list of this site's toplevel navbars sorted by navbar.order

The code is a little roundabout for a few reasons:
	- liquid doesn't provide a simple way to create an empty array,
	so we just split an empty string.
	- liquid stores the navbars (in site.data[version].navbars) as
	a list keyed by the filename. We don't really care about the filename
	here, so we just need the data field. But, liquid doesn't provide a
	simple way to 'iteritems', so we have to manually loop through and access
	the	2nd item.
	- liquid also has a bug where it truncates after first `.` of a directory
	name in _data (i.e. _data/v0.1 will be stored as data.v0). Until that
	bug's fixed, we store version data in _data/v0_1 and do a string replace
	to find the right data.
{% endcomment %}

{% assign current_page = page.path | replace_first: page.version,"" | split: "/" %}
{% assign current_page = current_page[1] | prepend: "/" %}

{% capture version %}{{ page.version | replace: ".","_" }}{% endcapture %}

{% assign unsorted_navbars = "" | split:"|" %}
{% for navbars_hashmap in site.data[version].navbars %}
	{% assign navbar = navbars_hashmap[1] %}
	{% assign unsorted_navbars = unsorted_navbars | push: navbar %}
	{% assign navbar_size = navbar.path | size %}
	{% if current_page == navbar.path %}
		{% assign this_pages_navbar = navbar %}
	{% endif %}
{% endfor %}
{% assign navbars = unsorted_navbars | sort:"order" %}


<!Doctype html>
<html lang="en">

{% include head-header.html %}

<script type="text/javascript">
function redirect(version) {
	window.location = "{{site.baseurl}}/" + version + "/introduction"
}
</script>

<!--  HERO  -->
<section id="encyclopedia">
	<div class="container">
		<nav class="navbar navbar-default">
			<div class="container-fluid">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="#">Project Calico</a>
				</div>
				<div id="navbar" class="navbar-collapse collapse">
					<ul class="nav navbar-nav">
						{% for navbar in navbars %}
							<li{% if this_pages_navbar == navbar %} class="active"{% endif %}>
								<a href="{{site.baseurl}}/{{page.version}}{{navbar.path}}">{{ navbar.bigheader }}</a>
							</li>
						{% endfor %}
						<li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="#">Action</a></li>
            <li><a href="#">Another action</a></li>
            <li><a href="#">Something else here</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="#">Separated link</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="#">One more separated link</a></li>
          </ul>
        </li>
					</ul>
					<ul class="nav navbar-nav navbar-right">
						<li class="active"><a href="./">Documentation <span class="sr-only">(current)</span></a></li>
						<li><a href="../navbar-static-top/">Support</a></li>
						<li><a href="../navbar-fixed-top/">Blog</a></li>
					</ul>
				</div><!--/.nav-collapse -->
			</div><!--/.container-fluid -->
		</nav>

		<div class="row">
			<div class="col-sm-3">
	<div id="docsToc">
        <div class="pi-accordion">
				{% include sidebar.html sidebar=this_pages_navbar.toc %}
        </div> <!-- /pi-accordion -->
		<button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
	</div> <!-- /docsToc -->
</div>
<div class="col-sm-9">
	<div id="">
    	{% if notitle != "true" %}<h1>{{ title }}</h1>{% endif %}
		{{ content }}
	</div>
</div>
</div>
</div>
</section>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
	.cse .gsc-control-cse, .gsc-control-cse, {
		padding: 0;
	}
	.gsc-control-cse table, .gsc-control-cse-en table {
		margin:0px !important;
	}

	.gsc-above-wrapper-area {
		border-bottom: 0;
	}
</style>
</body>
</html>
